<div class="dashboard">
    <section class="message-section" [ngStyle]="{'margin-right' : this.threadService.threadIsOpen ? '25px' : ''}">
        <header>
            <div class="channel_info_box">
                <span (click)="openChannelMenu()">{{channel?.channelName}}</span>
                <mat-icon>expand_more</mat-icon>
            </div>
            <div class="user_channel_info_box">
                <div class="user_in_channel_box">
                    <div class="user_avatar_box">
                        <div *ngFor="let user of channel?.usersData;let i=index;">
                            <img *ngIf="i < 3" [ngStyle]="{'right.px': i * 25, 'z-index': 2 - i}" [src]="user.photoURL"
                                alt="User image">
                            <!-- Display the "+number" if there are more than three users -->
                        </div>
                    </div>
                    <div class="user_amount_box">{{channel?.usersData.length}}</div>
                </div>
                <div class="add_user" (click)="openPeopleUserlDialog()">
                    <mat-icon>person_add</mat-icon>
                </div>
            </div>
        </header>
        <main id="scroller" [appScrollBottom]="getAllMessages()">
            <app-message *ngFor="let msg of getAllMessages()" [message]="msg"></app-message>
        </main>

        <div class="input_message_container">
            <textarea #myTextarea [(ngModel)]="text" placeholder="Nachricht an #{{channel?.channelName}}"></textarea>
            <div class="control_container">
                <div class="chat_action_box">
                    <div class="file_upload_button">
                        <label for="fileUpload">
                            <mat-icon class="action_btn_style">add</mat-icon>
                        </label>
                        <input type="file" style="display:none;" id="fileUpload" (change)="onUpload($event)">
                    </div>
                    <hr>
                    <mat-icon (click)="toggleEmoji($event)" class="action_btn_style">sentiment_satisfied</mat-icon>
                    <app-emoji-picker *ngIf="isOpened" (emojiSelectedEvent)="addEmoji($event)" appClickOutside (clickOutside)="onOutsideClick()"></app-emoji-picker>
                    <mat-icon (click)="openTagMenu()" class="action_btn_style">alternate_email</mat-icon>
                    <div *ngIf="fileUpload" class="file_to_upload">
                        <mat-icon (click)="onDelete(fileUpload.path)" class="delete_btn">close</mat-icon>
                        <img style="height: 45px;" src="{{fileType}}" alt="">
                    </div>
                    <div class="tagMenuOuterContainer">
                        <div *ngIf="showTagMenu" class="tagMenuInnerContainer">
                            <div class="user" *ngFor="let user of allUsers" (click)="tagUser(user.name)">
                                <img src="{{user.photoURL}}" alt="">
                                <span>{{user.name}}</span>
                            </div>
                        </div>
                    </div>
                </div>
                <button [disabled]="text.length == 0" (click)="sendMessageTo('channel', channel.channelId)"><mat-icon
                        [ngStyle]="{'color' : text.length == 0 ? 'grey' : '#535AF1'}" class="send_btn">send</mat-icon></button>
            </div>
        </div>
    </section>
    <section [@slide] class="thread-section" *ngIf="this.threadService.threadIsOpen">
        <app-threads></app-threads>
    </section>
</div>