<header>
  <div class="left-side">
    <img
      *ngIf="this.drawerService.isDrawerOpen && this.drawerService.checkScreenSize() || !this.drawerService.checkScreenSize()"
      class="logo" src="../assets/img/logo+text.png">
    <img (click)="this.drawerService.open(); this.threadService.closeThread()"
      *ngIf="!this.drawerService.isDrawerOpen && this.drawerService.checkScreenSize()" class="open-menu"
      src="assets/img/open-menu-button.png" alt="">
  </div>
  <div class="logo-search-box">
    <div class="search-box">
      <app-search-bar [messageSearch]="true"></app-search-bar>
    </div>
  </div>
  <div class="profil-box" *ngIf="currentUser" [matMenuTriggerFor]="menu" #menuTrigger="matMenuTrigger"
    (menuOpened)="isMenuOpen = true" (menuClosed)="isMenuOpen = false">
    <span class="profil-name">{{ loggedinUser?.name}}</span>
    <div class="align-right" style="position: relative;">
      <img class="avatar" src="{{ currentUser.photoURL }}">
      <app-user-presence [userID]="currentUser.id" style="position: absolute !important;
        bottom: 2px !important;
        right: 5px !important;">
      </app-user-presence>
    </div>
    <button mat-icon-button>
      <img class="arrow-down" src="../assets/img/arrow-down.png"></button>
  </div>
  <div class="backdrop" *ngIf="isMenuOpen" (click)="closeMenu()"></div>

  <mat-menu #menu="matMenu" class="profile-menu">
    <div class="rectangle-centered">
      <img *ngIf="this.drawerService.checkScreenSizeForResponsive(450)" src="../assets/img/rectangle.png">
    </div>
    <button class="menu-btn" mat-menu-item (click)="openUserProfile()">
      <div>
        <img *ngIf="this.drawerService.checkScreenSizeForResponsive(450)" class="person-icon"
          src="../assets/img/person.png"><span>Profile</span>
      </div>
    </button>
    <button class="menu-btn" mat-menu-item (click)="userLoggedout()">
      <div>
        <img *ngIf="this.drawerService.checkScreenSizeForResponsive(450)"
          src="../assets/img/logout.png"><span>Logout</span>
      </div>
    </button>
  </mat-menu>
</header>
<button class="toggle-box" (click)="toggleDrawer()">

  <span class="material-symbols-outlined" *ngIf="!isDrawerOpen">
    right_panel_open
  </span>
  <span class="material-symbols-outlined" *ngIf="isDrawerOpen">
    right_panel_close
  </span>
  <div>{{ isDrawerOpen ? 'Workspace-menu schließen' : 'Workspace-menu öffnen' }} </div>
</button>

<mat-drawer-container class="mat-drawer-container">
  <mat-drawer #drawer [opened]="true" [@drawerAnimation]="isDrawerOpen ? 'open' : 'closed'" class="sidenav" mode="side" (opened)="onDrawerOpened()"
    (closed)="onDrawerClosed()">

    <div class="mat-drawer-box">
      <div class="sidenav-header sticky">
        <div class="logo-box">
          <img class="workspace-logo" src="../assets/img/workspace.png">
          <span>Code learning</span>
        </div>
        <div [routerLink]="['message']" class="edit-div">
          <img class="edit-icon" src="../assets/img/edit_square.png">
          <div class="bg-div"></div>
        </div>
      </div>
      <div class="sticky scrollbar" *ngIf="isMobile">
        <app-search-bar [isMobile]="true"></app-search-bar>
      </div>
      <div class="tree">
        <app-channels></app-channels>
        <app-direct-chat></app-direct-chat>
      </div>
    </div>
    <button (click)="drawer.close()" [routerLink]="['message']" *ngIf="isDrawerOpen && isMobile" mat-fab color="primary"
      class="new-msg-mobile-button">
      <mat-icon>edit_square</mat-icon>
    </button>
  </mat-drawer>
  <mat-drawer-content [class.drawer-open]="!isDrawerOpen">
    <router-outlet></router-outlet>
  </mat-drawer-content>
</mat-drawer-container>